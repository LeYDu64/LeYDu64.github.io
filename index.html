<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="theme-color" content="#1a120b">
<title>üëë Le Ren√©gat du Royaume</title>

<style>
// ===== AUDIO =====

let music = new Audio("music.mp3");
let revealSound = new Audio("reveal.mp3");
let voteSound = new Audio("vote.mp3");
let winSound = new Audio("win.mp3");

music.loop = true;
music.volume = 0.4;

let soundEnabled = true;

// D√©marrer musique au premier clic (important mobile)
document.addEventListener("click", function startMusic(){
    if(soundEnabled){
        music.play();
    }
    document.removeEventListener("click", startMusic);
});

/* === ANIMATIONS === */

.fadeIn {
    animation: fadeIn 0.5s ease forwards;
}

.slideUp {
    animation: slideUp 0.4s ease forwards;
}

.pop {
    animation: pop 0.3s ease;
}

.shake {
    animation: shake 0.4s;
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

@keyframes slideUp {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes pop {
    0% { transform: scale(0.7); }
    70% { transform: scale(1.1); }
    100% { transform: scale(1); }
}

@keyframes shake {
    0% { transform: translateX(0); }
    20% { transform: translateX(-5px); }
    40% { transform: translateX(5px); }
    60% { transform: translateX(-5px); }
    80% { transform: translateX(5px); }
    100% { transform: translateX(0); }
}

/* Effet pression bouton */
button:active {
    transform: scale(0.95);
}

body{
margin:0;
font-family:'Georgia',serif;
color:#f5deb3;
text-align:center;
background:radial-gradient(circle at top,#3b2a1d,#1a120b 60%);
}
.container{max-width:520px;margin:auto;padding:20px;}
.logo{font-size:32px;font-weight:bold;color:gold;text-shadow:0 0 10px gold;}
.card{
background:linear-gradient(145deg,#2b1d13,#1a120b);
padding:20px;margin-top:20px;border-radius:18px;
box-shadow:0 0 25px rgba(255,215,0,0.2);
border:1px solid rgba(255,215,0,0.2);
}
input{
padding:10px;margin:6px;border-radius:8px;
border:1px solid #b8860b;background:#1a120b;color:#f5deb3;
}
button{
background:linear-gradient(145deg,#b8860b,#8b6508);
border:none;padding:12px;margin:8px 0;width:100%;
font-size:16px;border-radius:10px;color:white;
cursor:pointer;font-weight:bold;
}
button:hover{background:linear-gradient(145deg,#d4af37,#a67c00);}
.playerButton{background:linear-gradient(145deg,#5a3e2b,#3b2a1d);}
.ruleBtn{background:#3e6b48;}
.resetBtn{background:#6b2c2c;}
.hidden{display:none;}
</style>
</head>

<body>
<style>
body {
    margin:0;
    font-family:'Georgia',serif;
    color:#f5deb3;
    text-align:center;
    background:radial-gradient(circle at top,#3b2a1d,#1a120b 60%);
}
.container {
    max-width:520px;
    margin:auto;
    padding:20px;
}
.logo {
    font-size:32px;
    font-weight:bold;
    color:gold;
    text-shadow:0 0 10px gold;
}
.card {
    background:linear-gradient(145deg,#2b1d13,#1a120b);
    padding:20px;
    margin-top:20px;
    border-radius:18px;
    box-shadow:0 0 25px rgba(255,215,0,0.2);
    border:1px solid rgba(255,215,0,0.2);
}

/* === Inputs et boutons uniformes pour local + en ligne === */
#setup input,
#onlineMode input {
    width: 100%;
    margin: 6px 0;
    padding: 10px;
    border-radius: 8px;
    border: 1px solid #b8860b;
    background: #1a120b;
    color: #f5deb3;
    font-size: 16px;
    box-sizing: border-box;
}

#setup button,
#onlineMode button {
    width: 100%;
    margin: 8px 0;
    padding: 12px;
    font-size: 16px;
    border-radius: 10px;
    font-weight: bold;
    color: white;
    border: none;
    cursor: pointer;
    background: linear-gradient(145deg,#b8860b,#8b6508);
    box-sizing: border-box;
}

#setup button:hover,
#onlineMode button:hover {
    background: linear-gradient(145deg,#d4af37,#a67c00);
}
</style>
</head>

<body>
<div class="container">

<div class="logo">üëë Le Ren√©gat du Royaume</div>

<!-- ========================= -->
<!-- MODE LOCAL -->
<!-- ========================= -->
<div id="setup" class="card">
  <h3>‚öî Configuration Locale</h3>

  <input type="number" id="playerCount" min="3" placeholder="Nombre de joueurs">
  <input type="number" id="impostorCount" min="0" placeholder="Nombre de Ren√©gats">
  <input type="number" id="idiotCount" min="0" placeholder="Nombre d'Idiots du Royaume">

  <div id="nameInputs"></div>

  <button onclick="alert('Valider joueurs')">Valider joueurs</button>
  <button onclick="alert('Lancer la partie')">Lancer la partie</button>
</div>

<!-- ========================= -->
<!-- MODE EN LIGNE -->
<!-- ========================= -->
<div id="onlineMode" class="card">
  <h3>üåê Mode En Ligne</h3>

  <!-- Cr√©er une partie -->
  <input type="text" id="playerNameCreate" placeholder="Ton pseudo">
  <button onclick="alert('Cr√©er une partie')">Cr√©er une partie</button>

  <hr style="border:1px solid rgba(255,215,0,0.2); margin:12px 0;">

  <!-- Rejoindre une partie -->
  <input type="text" id="roomCode" placeholder="Code de la partie">
  <input type="text" id="playerNameJoin" placeholder="Ton pseudo">
  <button onclick="alert('Rejoindre une partie')">Rejoindre une partie</button>
</div>

</div>
<button class="ruleBtn" onclick="toggleRules()">R√®gles</button>
<button class="resetBtn" onclick="resetData()">R√©initialiser</button>
</div>

<div id="rules" class="card hidden">
<h3>üìú R√¥les</h3>
<p>
üë®‚Äçüåæ <b>Villageoi</b> : A un mot.<br><br>
üïµÔ∏è <b>Ren√©gat</b> : A un mot diff√©rent de celui des villageois.<br><br>
ü§° <b>Idiot du Royaume</b> : N'a aucun mot.<br><br>
<h3>‚öñÔ∏è Conditions</h3>
<p>
Il y a minimum 3 joueurs, aucun minimum pour les ren√©gats et les idiots du royaume, cependant la partie ne se lance pas s'il n'y a pas de ren√©gat ni d'idiot du royaume.<br><br>
<h3>üö© But du jeu</h3>
<p>
Chaque joueur commence avec un mot hormis l'idiot du royaume, √† chaque tour le joueur d√©sign√© doit dire un mot similaire √† son mot d'origine.
√Ä son √©limination, l'idiot du royaume tente de deviner le mot des villageois, au vote, les joueurs d√©signent la personne qu'ils pensent √™tre ren√©gat ou idiot du royaume.
S'il n'y a plus de ren√©gat, les villageois gagnent, s'il y a autant de villageois que de ren√©gat, les ren√©gats gagnent, si l'idiot du royaume devine le mot des villageois, il gagne.
</p>
</div>

<div id="transition" class="card hidden">
<h3>Passe le t√©l√©phone √†</h3>
<h2 id="playerName"></h2>
<button onclick="showWord()">Voir mon r√¥le</button>
</div>

<div id="reveal" class="card hidden">
<h2 id="wordText"></h2>
<button onclick="nextPlayer()">Cacher</button>
</div>

<div id="voteScreen" class="card hidden">
<h3>Votez un joueur</h3>
<div id="voteButtons"></div>
</div>

<div id="resultScreen" class="card hidden"></div>

</div>

<script>

let players=[];
let currentPlayer=0;
let villageWord="";
let impostorWord="";

const words=[
["Chat","Tigre"],["Lion","Panth√®re"],["Chien","Loup"], ["Pizza","Burger"],["P√¢tes","Riz"],["Frites","Chips"], ["Voiture","Moto"],["Locomotive","Wagon"],["Avion","H√©licopt√®re"], ["Mer","Piscine"],["Montagne","Colline"],
  ["For√™t","Jungle"], ["Ordinateur","Tablette"],["T√©l√©phone","Radio"],["Cam√©ra","Appareil photo"], ["Film","S√©rie"],["Livre","Magazine"],["H√¥pital","V√©t√©rinaire"],["Caf√©","Th√©"], ["Chocolat","Bonbon"],
  ["Bateau","Sous-marin"],["Neige","Glace"],["Pomme","Poire"], ["Fraise","Framboise"],["Chaussure","Botte"],["Chemise","Veste"], ["Soleil","Lune"],["Mer","Oc√©an"],["Police","Pompier"], ["Roi","Prince"],
  ["Supermarch√©","Boulangerie"], ["Football","Basket"],["Paris","Londres"], ["Netflix","YouTube"],["Amazon","eBay"], ["Facebook","Instagram"],["Snapchat","TikTok"], ["McDonald's","Burger King"],
  ["Pepsi","Coca-Cola"], ["Ferrari","Lamborghini"],["Nike","Adidas"], ["Marvel","DC"],["Bitcoin","Ethereum"], ["Samsung","Apple"], ["Xbox","PlayStation"],["Windows","Mac"], ["Google","FireFox"],
  ["Airbnb","Hotel"], ["Uber","Taxi"],["Croissant","Pain au chocolat"], ["Fromage","Beurre"],["Bi√®re","Vin"], ["Guitare","Piano"],["Drame","Com√©die"], ["Action","Horreur"],["Zombie","Vampire"], 
  ["Dragon","Dinosaure"], ["Clown","Magicien"], ["Pluie","Orage"],["D√©sert","Savane"], ["Cin√©ma","Th√©√¢tre"],["PlayMobil","LEGO"],["Mario","Link"],["Zelda","Ganondorph"],["Feutre","Peinture"],["Croquis","Dessin"],
  ["Ch√¢teau", "Forteresse"],
        ["Dragon", "Serpent"],
        ["√âp√©e", "Dague"],
        ["Couronne", "Diad√®me"],
        ["Chevalier", "Soldat"]
];

function animate(element, animation){
    element.classList.remove(animation);
    void element.offsetWidth;
    element.classList.add(animation);
}

function saveConfig(){
const config={
playerCount:playerCount.value,
impostorCount:impostorCount.value,
idiotCount:idiotCount.value,
names:getNames()
};
localStorage.setItem("royaumeConfig",JSON.stringify(config));
}

function loadConfig(){
const saved=JSON.parse(localStorage.getItem("royaumeConfig"));
if(!saved) return;
playerCount.value=saved.playerCount;
impostorCount.value=saved.impostorCount;
idiotCount.value=saved.idiotCount||0;
generateNameInputs();
setTimeout(()=>{
saved.names.forEach((name,i)=>{
let input=document.getElementById("name"+i);
if(input) input.value=name;
});
},100);
}

function resetData(){
localStorage.removeItem("royaumeConfig");
location.reload();
}

function shuffle(array){
for(let i=array.length-1;i>0;i--){
let j=Math.floor(Math.random()*(i+1));
[array[i],array[j]]=[array[j],array[i]];
}
}

function getNames(){
let names=[];
for(let i=0;i<playerCount.value;i++){
names.push(document.getElementById("name"+i)?.value||("Joueur "+(i+1)));
}
return names;
}

function generateNameInputs(){
let count=parseInt(playerCount.value)||0;
let container=document.getElementById("nameInputs");
container.innerHTML="";
for(let i=0;i<count;i++){
let input=document.createElement("input");
input.id="name"+i;
input.placeholder="Nom joueur "+(i+1);
container.appendChild(input);
}
saveConfig();
}

function startGame(){

saveConfig();

let count=parseInt(playerCount.value)||0;
let impostors=parseInt(impostorCount.value)||0;
let idiotCountValue=parseInt(idiotCount.value)||0;

if(count<3){
alert("Minimum 3 joueurs.");
return;
}

if(impostors<0||idiotCountValue<0){
alert("Valeur invalide.");
return;
}

if(impostors+idiotCountValue>=count){
alert("Trop de r√¥les sp√©ciaux.");
return;
}

if(impostors===0 && idiotCountValue===0){
alert("Il faut au moins un Ren√©gat ou un Idiot du Royaume.");
return;
}

players=[];

let pair=words[Math.floor(Math.random()*words.length)];
villageWord=pair[0];
impostorWord=pair[1];

let names=getNames();

for(let i=0;i<count;i++){
players.push({
name:names[i],
role:"Villageois",
word:villageWord,
alive:true
});
}

shuffle(players);

for(let i=0;i<impostors;i++){
players[i].role="Ren√©gat";
players[i].word=impostorWord;
}

let index=impostors;
for(let i=0;i<idiotCountValue;i++){
players[index].role="Idiot du Royaume";
players[index].word="";
index++;
}

shuffle(players);

currentPlayer=0;
setup.classList.add("hidden");
transition.classList.remove("hidden");
playerName.innerText=players[currentPlayer].name;
}

function showWord(){
animate(document.getElementById("reveal"), "pop");
transition.classList.add("hidden");
reveal.classList.remove("hidden");

let player=players[currentPlayer];

if(player.role==="Idiot du Royaume"){
wordText.innerText = player.name + ", tu es l'Idiot du Royaume ü§°";
}else{
wordText.innerText = player.name + ", ton mot est : " + player.word;
}
}


function nextPlayer(){
currentPlayer++;
if(currentPlayer>=players.length){
reveal.classList.add("hidden");
initTurns();
return;
}
reveal.classList.add("hidden");
transition.classList.remove("hidden");
playerName.innerText=players[currentPlayer].name;
}

function startVote(){
animate(document.getElementById("voteScreen"), "slideUp");
voteScreen.classList.remove("hidden");
voteButtons.innerHTML="";
players.forEach(p=>{
if(p.alive){
let btn=document.createElement("button");
btn.className="playerButton";
btn.innerText=p.name;
btn.onclick=()=>eliminate(p);
voteButtons.appendChild(btn);
}
});
}

function eliminate(player){
player.alive=false;
voteScreen.classList.add("hidden");
resultScreen.classList.remove("hidden");
resultScreen.innerHTML="<h3>"+player.name+" √©tait "+player.role+"</h3>";

if(player.role==="Idiot du Royaume"){
let guess=prompt("Quel est le mot des villageois ?");
if(guess && guess.toLowerCase()===villageWord.toLowerCase()){
resultScreen.innerHTML+="<h2>ü§° L'Idiot triomphe ! ü§°</h2>";
resultScreen.innerHTML+="<button onclick='location.reload()'>Nouvelle partie</button>";
return;
}
}

let impostorsAlive=players.filter(p=>p.role==="Ren√©gat"&&p.alive).length;
let villagersAlive=players.filter(p=>p.role==="Villageois"&&p.alive).length;

if(impostorsAlive===0){
resultScreen.innerHTML+="<h2>üéâ Victoire des Villageois</h2>";
resultScreen.innerHTML+="<button onclick='location.reload()'>Nouvelle partie</button>";
return;
}

if(impostorsAlive>=villagersAlive){
resultScreen.innerHTML+="<h2>üíÄ Victoire des Ren√©gats</h2>";
resultScreen.innerHTML+="<button onclick='location.reload()'>Nouvelle partie</button>";
return;
}

resultScreen.innerHTML+="<button onclick='nextRound()'>Continuer</button>";
}

function nextRound(){
resultScreen.classList.add("hidden");
startVote();
}

function toggleRules(){
rules.classList.toggle("hidden");
}

loadConfig();
</script>
<!-- Scripts de ton jeu local -->
<script src="tour.js"></script>

<!-- Firebase v8 -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>

<!-- Ton script en ligne -->
<script src="online.js"></script>
</body>
</html>
